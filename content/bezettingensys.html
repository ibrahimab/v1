<?php echo"<script type=\"text/javascript\" src=\"".$vars["basehref"]."scripts/popupcalendar.js\"></script>";
?>
<script language="javascript" type="text/javascript">
var cal = new CalendarPopup();
function getRapport(){
	if(document.getElementById('Maandeen').value==""){
		window.alert("Geef a.u.b een geldige begin maand op.");
	}
	else if(document.getElementById('Maandtwee').value==""){
		window.alert("Geef a.u.b een geldige eind maand op.");
	}
	else{
		window.location = "/chalet/bezettingensys.php?periode=true&van=" + document.getElementById('Maandeen').value+"&tot="+document.getElementById('Maandtwee').value;
	}
}

function exportFile(){
		var ajaxRequest;  // The variable that makes Ajax possible!
		try{
			ajaxRequest = new XMLHttpRequest();
		}catch (e){
			try{
				ajaxRequest = new ActiveXObject("Msxml2.XMLHTTP");
			}catch (e) {
				try{
					ajaxRequest = new ActiveXObject("Microsoft.XMLHTTP");
				}catch (e){
					alert("Your browser broke!");
						return false;
				}
			}
		}
		ajaxRequest.onreadystatechange = function(){
			if(ajaxRequest.readyState == 4){
				if(sessionStorage.van == null && sessionStorage.tot == null){
					window.location = "/chalet/bezettingensys.php?exportFile=true&periode=false";
					return false;
				}
				else if(sessionStorage.van != null && sessionStorage.tot != null){
					window.location = "/chalet/bezettingensys.php?exportFile=true&periode=true&van=" + sessionStorage.van+"&tot="+sessionStorage.tot;
					//sessionStorage.van = null;
					//sessionStorage.tot = null;
					return false;
				}
			}
		}
		if(sessionStorage.van == null && sessionStorage.tot == null){
			var queryString = "?exportFile=true&periode=false";
		}
		else if(sessionStorage.van != null && sessionStorage.tot != null){
			var queryString = "?periode=true&van=" + sessionStorage.van ;
			queryString +=  "&tot=" + sessionStorage.tot;
		}
			//queryString +=  "&tot=" + document.getElementById('Maandtwee').value;
			ajaxRequest.open("GET", queryString, true);
			ajaxRequest.send(null);
}
//printen gebeurt al in excel
<!--function printDiv(divName) {-->
<!--	var content=document.getElementById(divName).innerHTML;-->
<!--	var pwin=window.open('','print_content','width=800,height=600');-->
<!--	pwin.document.open();-->
<!--	pwin.document.write('<html><body onload="window.print()">'+content+'</body></html>');-->
<!--	pwin.document.close();-->
<!--	setTimeout(function(){pwin.close();},1000);-->
<!--} -->
</script>
<?php

function deep_ksort(&$arr) {
    ksort($arr);
    foreach ($arr as &$a) {
        if (is_array($a) && !empty($a)) {
            deep_ksort($a);
        }
    }
}

function in_array_r($needle, $haystack, $strict = true) {
    foreach ($haystack as $item) {
        if (($strict ? $item === $needle : $item == $needle) || (is_array($item) && in_array_r($needle, $item, $strict))) {
            return true;
        }
    }

    return false;
}

$status["beschikbaar"]="#ccffcc";
$status["Navragen"]="#fcd5b4";
$status["inoptie"]="#ffff00";
$status["viachalet"]="#93cddd";
$status["doorDerden"]="#800080";
$status["geblokeerd"]="#e5e0ec";
$status["nietbeschikbaar"]="#ff2439";
$status["inplaning"]="#FFFFFF";

$beschikbaar = array(
	'fill' => array(
        'type' => PHPExcel_Style_Fill::FILL_SOLID,
        'color' => array('rgb'=>'ccffcc'),
    ),
);
$inplaning = array(
	'fill' => array(
        'type' => PHPExcel_Style_Fill::FILL_SOLID,
        'color' => array('rgb'=>'ffffff'),
    ),
);
$nietbeschikbaar = array(
	'fill' => array(
        'type' => PHPExcel_Style_Fill::FILL_SOLID,
        'color' => array('rgb'=>'ff2439'),
    ),
);
$geblokeerd = array(
	'fill' => array(
        'type' => PHPExcel_Style_Fill::FILL_SOLID,
        'color' => array('rgb'=>'e5e0ec'),
    ),
);
$doorDerden = array(
	'fill' => array(
        'type' => PHPExcel_Style_Fill::FILL_SOLID,
        'color' => array('rgb'=>'800080'),
    ),
);
$viachalet = array(

	'fill' => array(
        'type' => PHPExcel_Style_Fill::FILL_SOLID,
        'color' => array('rgb'=>'93cddd'),
    ),
);
$inoptie = array(

	'fill' => array(
        'type' => PHPExcel_Style_Fill::FILL_SOLID,
        'color' => array('rgb'=>'ffff00'),
    ),
);
$Navragen = array(

	'fill' => array(
        'type' => PHPExcel_Style_Fill::FILL_SOLID,
        'color' => array('rgb'=>'fcd5b4'),
    ),
);

$db->query("SELECT contactpersoon_contract FROM leverancier WHERE leverancier_id='130';");
if($db->next_record()){
	$naam=$db->f("contactpersoon_contract");
	//echo "<b>Welkom, ".wt_he($db->f("contactpersoon_contract"))."</b><BR><BR>";
}
?>
<form name="periode">
<table>
  <tr>
    <td>Periode:</td>
    <td><input type="text" name=date1 id="Maandeen" readonly="readonly" value=""><A HREF="#"

   onClick="cal.select(document.forms['periode'].date1,'Maandeen','yyyy-MM-dd'); return false;"
   NAME="Maandeen" ID="Maandeen">Selecteer</A>
    </input>
    </td>
    <td><input type="text" name=date2 id="Maandtwee" readonly="readonly" value=""><A HREF="#"

   onClick="cal.select(document.forms['periode'].date2,'Maandtwee','yyyy-MM-dd'); return false;"
   NAME="Maandtwee" ID="Maandtwee">Selecteer</A>
    </input>
    </td>
  	<td><input type="button" value="Rapport ophalen" onclick="getRapport()" </td>
  </tr>
  <tr>
  	<td height="20"></td>
  </tr>
  <tr>
  	<td><a href="#" onclick="exportFile()">Excel bestand exporteren</a></td>
  </tr>
</table>
</form>
<?php
if(isset($_GET["exportFile"])=="true"){

		$datumFrom=strtotime($_GET["van"]);
		$datumTo=strtotime($_GET["tot"]);
		$objPHPExcel = new PHPExcel();
		$sheet = $objPHPExcel->getActiveSheet();
		$sheet->setCellValue('A1', '');
		$sheet->setCellValue('B1', '');
		$sheet->setCellValue('C1', 'Weken');
		$sheet->setCellValue('A2', '');
		$sheet->setCellValue('B2', 'Eigenaarsnaam');
		$sheet->setCellValue("C2", "");
		$datumToTo=$datumTo;
		$datumFromFrom=$datumFrom;
		$verschil=$datumToTo-$datumFromFrom;
		$years = floor($verschil / (365*60*60*24));
		$months = floor(($verschil - $years * 365*60*60*24) / (30*60*60*24));
		$days = floor(($diff - $years * 365*60*60*24 - $months*30*60*60*24)/ (60*60*24));
		$a=0;
		$l="C";
		$next_l=$l;
		do{
			$datumFromFrom=strtotime('+1 day', $datumFromFrom);
			$maan=date("M",$datumFromFrom);
			$maan.=" ";
			$maan.=date("Y",$datumFromFrom);
			if(date("l",$datumFromFrom)=="Saturday" and $a<4*$verschil){
				$data=date("d",$datumFromFrom);
				if($a==0 or $a%4*$verschil==0){
					$sheet->setCellValue($next_l."2", $maan);
				}
				$sheet->setCellValue($next_l."3", $data);
				++$next_l;
				$sheet->setCellValue($next_l."3", "");
				++$next_l;
				$sheet->setCellValue($next_l."3", "");
				++$next_l;
				$sheet->setCellValue($next_l."3", "");
				++$next_l;
				$sheet->setCellValue($next_l."3", "");
				++$next_l;
				$sheet->setCellValue($next_l."3", "");
				++$next_l;
				$a++;
			}
		}
		while($datumFromFrom < $datumToTo);
		$huidigerij=4;
		$l="C";
		$next_l=$l;
		$idss=array();
		$excelDagen=array();
		$excelDagen=$_SESSION["dagen"];
		$saturdays=array();
		$saturdays=$_SESSION["saturday"];
		deep_ksort($excelDagen);
		$start=$_SESSION["start"];
		$idss=$_SESSION["ids"];
		foreach($idss as $id){
			$sheet->setCellValue("A".$huidigerij,$id);
			$sheet->setCellValue("B".$huidigerij,$naam);

			$next_l="C";
			for($bl=0;$bl<$months;$bl++){
				$tmp=$saturdays[$start];
				$pos=1;
				for($blz=$pos;$blz<32;$blz++){
					//echo "blz ".$blz;
					if($excelDagen[$id][$start][$blz]=="#800080"){
						$sheet->getStyle($next_l.$huidigerij)->applyFromArray($doorDerden);
						++$next_l;
					}
					elseif($excelDagen[$id][$start][$blz]=="#ff2439"){
						$sheet->getStyle($next_l.$huidigerij)->applyFromArray($nietbeschikbaar);
						++$next_l;
					}
					elseif($excelDagen[$id][$start][$blz]=="#ffff00"){
						$sheet->getStyle($next_l.$huidigerij)->applyFromArray($inoptie);
						++$next_l;
					}
					elseif($excelDagen[$id][$start][$blz]=="#fcd5b4"){
						$sheet->getStyle($next_l.$huidigerij)->applyFromArray($Navragen);
						++$next_l;
					}
					elseif($excelDagen[$id][$start][$blz]=="#ccffcc"){
						$sheet->getStyle($next_l.$huidigerij)->applyFromArray($beschikbaar);
						++$next_l;
					}
					elseif($excelDagen[$id][$start][$blz]=="#FFFFFF"){
						$sheet->getStyle($next_l.$huidigerij)->applyFromArray($inplaning);
						++$next_l;
					}
					elseif($excelDagen[$id][$start][$blz]=="#93cddd"){
						$sheet->getStyle($next_l.$huidigerij)->applyFromArray($viachalet);
						++$next_l;
					}
					elseif($excelDagen[$id][$start][$blz]=="#ffff00"){
						$sheet->getStyle($next_l.$huidigerij)->applyFromArray($inoptie);
						++$next_l;
					}
				}
				if($start==12){
					$start=1;
				}
				$start++;
			}
			$huidigerij++;
			$next_l="C";
		}
		$huidigerij+=3;
		$sheet->setCellValue('A'.$huidigerij, "Legenda");
		$huidigerij++;
		$sheet->getStyle('A'.$huidigerij)->applyFromArray($beschikbaar);
		$sheet->setCellValue('A'.$huidigerij, "");
		$sheet->setCellValue('B'.$huidigerij, "Direct beschikbaar");
		$huidigerij++;
		$sheet->getStyle('A'.$huidigerij)->applyFromArray($Navragen);
		$sheet->setCellValue('A'.$huidigerij, "");
		$sheet->setCellValue('B'.$huidigerij, "Navragen bij eigenaar");
		$huidigerij++;
		$sheet->getStyle('A'.$huidigerij)->applyFromArray($inoptie);
		$sheet->setCellValue('A'.$huidigerij, "");
		$sheet->setCellValue('B'.$huidigerij, "Staat in optie voor klant");
		$huidigerij++;
		$sheet->getStyle('A'.$huidigerij)->applyFromArray($viachalet);
		$sheet->setCellValue('A'.$huidigerij, "");
		$sheet->setCellValue('B'.$huidigerij, "Boeking via Chalet.nl");
		$huidigerij++;
		$sheet->getStyle('A'.$huidigerij)->applyFromArray($doorDerden);
		$sheet->setCellValue('A'.$huidigerij, "");
		$sheet->setCellValue('B'.$huidigerij, "Boeking door derde");
		$huidigerij++;
		$sheet->getStyle('A'.$huidigerij)->applyFromArray($geblokeerd);
		$sheet->setCellValue('A'.$huidigerij, "");
		$sheet->setCellValue('B'.$huidigerij, "Geblokkeerd door eigenaar");
		$huidigerij++;
		$sheet->getStyle('A'.$huidigerij)->applyFromArray($nietbeschikbaar);
		$sheet->setCellValue('A'.$huidigerij, "");
		$sheet->setCellValue('B'.$huidigerij, "Niet beschikbaar voor verhuur");
		$huidigerij++;
		$sheet->getStyle('A'.$huidigerij)->applyFromArray($inplaning);
		$sheet->setCellValue('A'.$huidigerij, "");
		$sheet->setCellValue('B'.$huidigerij, "Nog niet in planning");

		$objWriter = PHPExcel_IOFactory::createWriter($objPHPExcel, 'Excel2007');
		$objWriter->save('testPHPExcel.xlsx');
		echo "Done writing<BR><BR>";
		echo "<a href=\"testPHPExcel.xlsx\">Download bestand</a><BR><BR>";
		unset($idss);
		unset($excelDagen);

}
if(!isset($_GET["exportFile"]) and $_GET["periode"]=="true"){
	$datumFrom=strtotime($_GET["van"]);
	$datumTo=strtotime($_GET["tot"]);

	$datumToTo=$datumTo;
	$datumFromFrom=$datumFrom;
	$verschil=$datumToTo-$datumFromFrom;
	$years = floor($verschil / (365*60*60*24));
	$months = floor(($verschil - $years * 365*60*60*24) / (30*60*60*24));
	$days = floor(($diff - $years * 365*60*60*24 - $months*30*60*60*24)/ (60*60*24));
	//$table="<div style=\"width:100%; height:300px;overflow:scroll;\">";
	$table.="<table width=\"100%\" class=\"calenderTable\" border=\"1\" cellspacing=\"0\">";
	$table.="<thead>";
	$table.="<tr>";
	$table.="<th></th>";
	$table.="<th></th>";
	$table.="<th colspan=\"1000\"><b>Weken</b></th>";
	$table.="</tr><tr>";
	$table.="<th></th>";
	$table.="<th><b>Eigenaar naam</b></th>";
	$table.="<th colspan=\"1000\">";
	$zaterdag = array();
	$table.="</th>";
	$table.="</tr></thead><tbody><tr>";
	//$table.="</tr><tr>";
	$maadenGedaan=0;
	$dagenarr=array();
	$ids=array();
	//ondestaand query vervangen door query. die de groep id van de huidige leverancier gaat uitlezen. daarna alle types van de groepen gaat ophalen de kopelingen samenvoegt en
	//een overzicht opbouwen en op het scherm tonen.
	$db->query("SELECT DISTINCT type_id FROM view_accommodatie WHERE leverancier_id='130' AND atonen=1 AND ttonen=1;");
	while($db->next_record()){
		//$db2->query("SELECT type_id FROM type WHERE zomerwinterkoppeling_accommodatie_id='".addslashes($db->f("type_id"))."';");
		//if($db2->next_record()){
		//	$inquery_type_id=$db->f("type_id").",".$db2->f("type_id");
		//}
		//else {
		//	$inquery_type_id=$db->f("type_id");
		//}
	$inquery_type_id=$db->f("type_id");
	array_push($ids,$db->f("type_id"));
	//echo count($inquery_type_id);

	$result2=$db4->query("SELECT ta.seizoen_id, ta.week, ta.beschikbaar, ta.voorraad_allotment, ta.voorraad_request, ta.voorraad_optie_klant, ta.opmerking_bezeteigenaar, ta.opmerking_boekingderden, ta.opmerking_nietbeschikbaarverhuur FROM tarief ta, accommodatie a, type t WHERE ta.type_id=t.type_id AND t.accommodatie_id=a.accommodatie_id AND ta.week BETWEEN ".addslashes($datumFrom)." AND ".addslashes($datumTo)." AND ta.type_id IN ('".addslashes($inquery_type_id)."') ORDER BY ta.week ASC;");
	if(count($result2)>0){
		$lev=$row2["contactpersoon_contract"];
		while($row2=mysql_fetch_array($result2)){
			if(!$row2["beschikbaar"] and $row2["opmerking_bezeteigenaar"]) {
				$stat2=$status["geblokeerd"];
			}
			elseif(!$row2["beschikbaar"] and $row2["opmerking_boekingderden"]){
				$stat2=$status["doorDerden"];
			}
			elseif(!$row2["beschikbaar"] and $row2["opmerking_nietbeschikbaarverhuur"]){
				$stat2=$status["nietbeschikbaar"];
			}
			if($row2["voorraad_optie_klant"]){
				$stat2=$status["inoptie"];
			}
			elseif($row2["voorraad_allotment"]) {
				$stat2=$status["beschikbaar"];
			}
			elseif($row2["voorraad_request"]){
				$stat2=$status["Navragen"];
			}
			if($row2["voorraad_optie_klant"]){
				$stat=$status["inoptie"];
			}
			elseif($row2["voorraad_allotment"]) {
				$stat=$status["beschikbaar"];
			}
			elseif($row2["voorraad_request"]){
				$stat=$status["Navragen"];
			}

			if(!$row2["beschikbaar"] and $row2["opmerking_bezeteigenaar"]) {
				$stat2=$status["geblokeerd"];
			}
			elseif(!$row2["beschikbaar"] and $row2["opmerking_boekingderden"]){
				$stat2=$status["doorDerden"];
			}
			elseif(!$row2["beschikbaar"] and $row2["opmerking_nietbeschikbaarverhuur"]){
				$stat2=$status["nietbeschikbaar"];
			}
			if($row2["voorraad_optie_klant"]){
				$stat2=$status["inoptie"];
			}
			elseif($row2["voorraad_allotment"]) {
				$stat2=$status["beschikbaar"];
			}
			elseif($row2["voorraad_request"]){
				$stat2=$status["Navragen"];
			}
			$dagenarr[$db->f("type_id")][date("m",$row2["week"])+0][date("d",$row2["week"])+0]=$stat;
			$maand=date("m",$row2["week"])+0;
			$dag=date("d",$row2["week"])+0;
			$dagenarr[$db->f("type_id")][$maand][$dag]=$stat;
			for($abc=0;$abc<7;$abc++){
				$dagenarr[$db->f("type_id")][$maand][$dag]=$stat;
				$dag++;
			}
		}
	}
	$result=$db3->query("SELECT b.aankomstdatum_exact, b.vertrekdatum_exact, UNIX_TIMESTAMP(b.besteldatum) AS besteldatum, bp.voornaam, bp.tussenvoegsel, bp.achternaam FROM boeking b, boeking_persoon bp WHERE b.aankomstdatum_exact BETWEEN ".addslashes($datumFrom)." AND ".addslashes($datumTo)." AND bp.boeking_id=b.boeking_id AND bp.persoonnummer=1 AND (b.type_id IN (".addslashes($inquery_type_id).") OR b.verzameltype_gekozentype_id IN (".addslashes($inquery_type_id).")) AND b.seizoen_id>=17 AND b.goedgekeurd=1 AND b.geannuleerd=0 AND b.boekingsnummer<>'';");
	if(count($result)>0){
		while($row=mysql_fetch_array($result)){
			if($row["besteldatum"]>0 or $row["vertrekdatum_exact"]<time()) {
				$stat=$status["viachalet"];
			}
			else {
				$stat=$status["inoptie"];
			}
			$aankomst=date("d",$row["aankomstdatum_exact"]);
			$vertrek=date("d",$row["vertrekdatum_exact"]);
			if(date("d",$row["aankomstdatum_exact"]) > date("d",$row["vertrekdatum_exact"])){
				$tussentijd=$aankomst+$vertrek;
				if($tussentijd>30){
					$tussentijd = 31;
				}
				for($z=$aankomst+0; $z<$tussentijd; $z++){
					$dagenarr[$db->f("type_id")][date("m",$row["aankomstdatum_exact"])+0][$z]=$stat;
					$bezet[date("m",$row["aankomstdatum_exact"])+0][$z]=$z;
				}
			}
			else{
				for($y=$aankomst+0;$y<$vertrek;$y++){
					$dagenarr[$db->f("type_id")][date("m",$row["aankomstdatum_exact"])+0][$y]=$stat;
					$bezet[date("m",$row["aankomstdatum_exact"])+0][$y]=$y;
				}
			}
		}
	}

	$table.="<td>".$db->f("type_id")."</td>";
	$table.="<td>".$naam."</td>";
	$table.="<td>";
	$table.="<table border=\"0\" cellspacing=\"0\" width=\"100%\">";
	$table.="<tbody><tr>";
	if($maadenGedaan==0){
	$data=date("M",$datumFromFrom);

	$table.="<td colspan=\"28\" width=\"5\">".$data."</td>";

	if($months > 1){
		for($ble=1;$ble<$months;$ble++){
		$datumFromFrom=strtotime('+1 month', $datumFromFrom);
			if($a<$months){
				$data=date("M",$datumFromFrom);
				$table.="<td colspan=\"28\" width=\"5\">".$data."</td>";

				$a++;
			}
		}
	}
	$table.="</tr></tbody><tbody><tr>";
		$datumFromFrom = $datumFrom;
	$z=0;
	do{
		for($x=1;$x<31;$x++){
			$datumFromFrom=strtotime('+1 day', $datumFromFrom);
			if(date("l",$datumFromFrom)=="Saturday"){
				$zaterdag[date("m",$datumFromFrom)+0][$pos]=date("d",$datumFromFrom);
				$pos++;
				$data=date("d",$datumFromFrom);
				$table.="<td width=\"5\">".$data."</td>";
				$table.="<td style=\"color:#FFFFFF\" width=\"5\"></td>";
				$table.="<td style=\"color:#FFFFFF\" width=\"5\"></td>";
				$table.="<td style=\"color:#FFFFFF\" width=\"5\"></td>";
				$table.="<td style=\"color:#FFFFFF\" width=\"5\"></td>";
				$table.="<td style=\"color:#FFFFFF\" width=\"5\"></td>";
			}
		}
		//$datumFromFrom=strtotime('+1 month', $datumFromFrom);
	}
	while($datumFromFrom < $datumToTo);
	//var_dump($zaterdag);
		$table.="</tr>";
		$table.="</tbody>";
		$table.="</table>";
		$maadenGedaan++;
	}
	$table.="<table border=\"0\" cellspacing=\"0\" width=\"100%\">";
	$table.="<tbody>";
	$table.="<tr>";
	$datumToTo=$datumTo;
	$datumFromFrom=$datumFrom;

	$table.="</tr></tbody><tbody><tr>";
		deep_ksort($dagenarr);
		$begin=date("m",$datumFromFrom)+0;
		$_SESSION["start"]=$begin;
		for($f=0;$f<$months;$f++){
			$tmp=$zaterdag[$begin];
			session_register("zaterdag");
			$_SESSION["saturday"]=$zaterdag;
			for($g=1;$g<32;$g++){

				if(in_array($g,$tmp)){
					if(substr($dagenarr[$db->f("type_id")][$begin][$g],0,1)!="#"){
						$table.="<td width=\"5\" height=\"10\" style=\"color:#FFFFFF\" bgcolor=\"#FFFFFF\"></td>";
						$table.="<td width=\"5\" height=\"10\" style=\"color:#FFFFFF\" bgcolor=\"#FFFFFF\"></td>";
						$table.="<td width=\"5\" height=\"10\" style=\"color:#FFFFFF\" bgcolor=\"#FFFFFF\"></td>";
						$table.="<td width=\"5\" height=\"10\" style=\"color:#FFFFFF\" bgcolor=\"#FFFFFF\"></td>";
						$table.="<td width=\"5\" height=\"10\" style=\"color:#FFFFFF\" bgcolor=\"#FFFFFF\"></td>";
						$table.="<td width=\"5\" height=\"10\" bgcolor=\"#FFFFFF\">|</td>";
					}
					else{
						$table.="<td width=\"5\" height=\"10\" style=\"color:".$dagenarr[$db->f("type_id")][$begin][$g]."\" bgcolor=\"".$dagenarr[$db->f("type_id")][$begin][$g]."\"></td>";
						$table.="<td width=\"5\" height=\"10\" style=\"color:".$dagenarr[$db->f("type_id")][$begin][$g]."\" bgcolor=\"".$dagenarr[$db->f("type_id")][$begin][$g]."\"></td>";
						$table.="<td width=\"5\" height=\"10\" style=\"color:".$dagenarr[$db->f("type_id")][$begin][$g]."\" bgcolor=\"".$dagenarr[$db->f("type_id")][$begin][$g]."\"></td>";
						$table.="<td width=\"5\" height=\"10\" style=\"color:".$dagenarr[$db->f("type_id")][$begin][$g]."\" bgcolor=\"".$dagenarr[$db->f("type_id")][$begin][$g]."\"></td>";
						$table.="<td width=\"5\" height=\"10\" style=\"color:".$dagenarr[$db->f("type_id")][$begin][$g]."\" bgcolor=\"".$dagenarr[$db->f("type_id")][$begin][$g]."\"></td>";
						$table.="<td width=\"5\" height=\"10\" bgcolor=\"".$dagenarr[$db->f("type_id")][$begin][$g]."\">|</td>";
					}
				}
			}
			if($begin==12){
				$begin=1;
			}
			else{
				$begin++;
			}
		}
	$table.="</tr>";
	$table.="</tbody>";
	$table.="</table>";
	$table.="</tr><tr>";
	}
	//tot hier herhalen
	$table.="</td>";
	$table.="</tr><tr>";

	$table.="</tr>";
	$table.="</tbody>";
	$table.="</table>";
	//$table.="</div>";
	echo $table;
	session_register("dagen");
	$_SESSION["dagen"]=$dagenarr;
	session_register("ids");
	$_SESSION["ids"]=$ids;
	unset($dagenarr);
	unset($ids);
	echo "<BR><BR><BR>";
}
else{
	echo "<BR><BR><b>Maak eerst een periode selectie a.u.b</b><BR><BR>";
}
?>

<table width="60%" border="0">
	<tr>
	<td colspan="2"><b>Legenda</b></td>
	</tr>
	<tr>
		<td bgcolor="#ccffcc" width="5%"></td><td>Direct beschikbaar</td>
	</tr>
	<tr>
		<td bgcolor="#fcd5b4" width="5%"></td><td>Navragen bij eigenaar</td>
	</tr>
	<tr>
		<td bgcolor="#e5e0ec" width="5%"></td><td>Geblokkeerd door eigenaar</td>
	</tr>
	<tr>
		<td bgcolor="#800080" width="5%"></td><td>Boeking door derde</td>
	</tr>
	<tr>
		<td bgcolor="#ff2439" width="5%"></td><td>Niet beschikbaar voor verhuur</td>
	</tr>
	<tr>
		<td bgcolor="#ffff00" width="5%"></td><td>Staat in optie voor klant</td>
	</tr>
	<tr>
		<td bgcolor="#93cddd" width="5%"></td><td>Boeking via Chalet.nl</td>
	</tr>
	<tr>
		<td bgcolor="#FFFFFF" width="5%"></td><td>Nog niet in planning</td>
	</tr>
</table>