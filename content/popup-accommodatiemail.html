<script type="text/javascript">
function validateEmail(email) {  
	var pattern = /^\w+@[a-zA-Z_]+?\.[a-zA-Z]{2,3}$/;
	return email.match(pattern);     
}  

function setVerzender(){
	//window.alert(document.getElementById("VerzenderNaam").value);
	//document.getElementById("Verzender").innerHTML = document.getElementById("VerzenderNaam").value;
}
function controlEnSend(){
	if(document.getElementById("VerzenderNaam").value == ""){
		//window.alert("OK");
		document.getElementById("Verzender").style.backgroundColor = 'red';
		document.getElementById("Verzender").style.color = 'white';
		document.getElementById("Verzender").style.padding = '10px';
		document.getElementById("Verzender").innerHTML = "U hebt uw naam niet ingevuld";
	}
	else if(document.getElementById("verzenderAdres").value == ""){
		//window.alert("OK");
		document.getElementById("Verzender").style.backgroundColor = 'red';
		document.getElementById("Verzender").style.color = 'white';
		document.getElementById("Verzender").style.padding = '10px';
		document.getElementById("Verzender").innerHTML = "U hebt uw email adres niet ingevuld";
	}
	else if(document.getElementById("EmailOntvanger").value == ""){
		//window.alert("OK");
		document.getElementById("Verzender").style.backgroundColor = 'red';
		document.getElementById("Verzender").style.color = 'white';
		document.getElementById("Verzender").style.padding = '10px';
		document.getElementById("Verzender").innerHTML = "U hebt de email adres(en) van de ontvanger(s) niet ingevuld";
	}
	else{
		var container = document.getElementById("EmailOntvanger").value;
		var emailAdressen = container.split(" ");
		for(var i =0; i < emailAdressen.length; i++){
			if(!validateEmail(emailAdressen[i])){
				window.alert(emailAdressen[i] + " is geen geldige email adres. Geef aub alleen maar geldige email adressen op.");
				document.getElementById("Verzender").style.backgroundColor = 'red';
				document.getElementById("Verzender").style.color = 'white';
				document.getElementById("Verzender").style.padding = '10px';
				document.getElementById("Verzender").innerHTML = "Vul A.u.b geldige email adres(sen) in";
				break;
			}
			else{
				document.getElementById("Verzender").innerHTML ="";
				document.forms["mailAcc"].submit();
				break;
			}
		}
	}
}
</script>

<?php

# Gegevens gekozen accommodatie opvragen
$accinfo=accinfo($_GET["accid"]);
echo "<p>Naam accommodatie: ".wt_he($accinfo["accnaam"])."</p>";

//echo "<p>Meer informatie over deze accommodatie: ".wt_dump($accinfo)."</p>";

if(isset($_POST['VerzenderNaam'])){
	$emails = explode(" ", $_POST['verzenderAdres']);
	for($i = 0; $i<sizeof($emails); $i++){
		$mail=new wt_mail;
		$mail->fromname=$vars["websitenaam"];
		$mail->from=$_POST['verzenderAdres'];
		$mail->toname=$_POST[''];
		$mail->to=$emails[$i];
		$mail->subject=$_POST['bericht'];
	
		$mail->plaintext=""; # deze leeg laten bij een opmaak-mailtje
	
		$mail->html_top="";
		//$mail->html="<b>Hier de inhoud van de mail met opmaak via html</b>"; # Hier kun je al je html in kwijt
		$mail->html_bottom="";
		$mail->send(); # mailtje daadwerkelijk verzenden
	}
	echo "<b>Bedankt, uw email(s) zijn verzonden</b>";
}

?>
<form action="<?php echo $_SERVER["REQUEST_URI"] ?>"  method="post" name="mailAcc">
<table id="mailTable">
  <tr>
    <td>Uw naam: </td>
  </tr>
  <tr>
    <td><input type="text" name="VerzenderNaam" id="VerzenderNaam" onkeyup="setVerzender()" /></td>
  </tr>
  <tr>
    <td>Van: (Email adres)</td>
  </tr>
  <tr>
    <td><label for="verzenderAdres"></label>
      <input type="text" name="verzenderAdres" id="verzenderAdres" /></td>
  </tr>
  <tr>
    <td>Aan: (Email adres(sen))</td>
  </tr>
  <tr>
    <td><label for="EmailOntvanger"></label>
      <input type="text" name="EmailOntvanger" id="EmailOntvanger" /></td>
  </tr>
  <tr>
    <td>Bericht:</td>
  </tr>
  <tr>
    <td>
    	<textarea name="bericht" cols="100" rows="8">Hallo! 
Ik heb een accomodatie gevonden op:
<?php echo wt_he($accinfo["url"]); ?>
 Wat vind je ervan?
Groeten,</textarea>	
      <div style="width:325px;" id="Verzender"></div><br /><br />
    </td>
  </tr>
  <tr>
    <td><button type="button" onclick="controlEnSend()" name="verzend" id="verzend" value="VERZENDEN">VERZENDEN</button>
    </td>
  </tr>
</table>
</form>
<?php


?>