<?php

$landinfo["id"]=5;

# Regio-array vullen
unset($tabellen,$landenteller,$landgehad);
$db->query("SELECT DISTINCT s.naam, l.naam".$vars["ttv"]." AS land, s.skigebied_id, s.minhoogte, s.maxhoogte, s.kilometerpiste, l.land_id FROM skigebied s, plaats p, land l WHERE l.land_id=p.land_id AND s.skigebied_id=p.skigebied_id AND s.websites LIKE '%".$vars["website"]."%' AND l.land_id='".addslashes($landinfo["id"])."' ORDER BY l.naam".$vars["ttv"].", s.naam;");
if($db->num_rows()) {
	while($db->next_record()) {

#echo $db->f("skigebied_id").":".$db->f("naam")."<br>";

		# aantal accommodaties opvragen
		$db2->query("SELECT count(t.type_id) AS aantal FROM skigebied s, plaats p, land l, type t, accommodatie a WHERE a.weekendski=0 AND t.accommodatie_id=a.accommodatie_id AND t.tonen=1 AND a.tonen=1 AND a.tonenzoekformulier=1 AND t.websites LIKE '%".$vars["website"]."%' AND a.plaats_id=p.plaats_id AND l.land_id=p.land_id AND s.skigebied_id=p.skigebied_id AND s.skigebied_id='".$db->f("skigebied_id")."' AND l.land_id='".$db->f("land_id")."' GROUP BY l.land_id, s.skigebied_id;");
		if($db2->next_record()) {
			$aantal_acc=$db2->f("aantal");
		} else {
			$aantal_acc=0;
		}

		$regio["aantal_acc"][$db->f("skigebied_id")]=intval($aantal_acc);
	}
}

$img_land="italie";
$img_style="width:490px;height:586px;";
#$landkaartklikbaar_kaart_style="margin-left:150px;";
$landkaart_hoverkleur="ff9900";
/*
$coords[apulie]="386,294,380,300,375,303,374,307,376,311,381,316,399,325,428,335,435,340,443,346,465,356,467,361,476,366,482,373,488,383,486,386,484,390,483,400,477,398,470,393,466,387,467,385,468,385,465,380,461,375,445,374,438,372,433,370,437,365,430,364,424,364,421,366,418,371,413,366,412,357,410,352,406,350,401,351,397,354,389,345,381,342,383,339,381,335,377,333,372,332,360,336,349,334,348,331,349,329,350,327,347,324,342,321,341,316,339,314,337,312,336,309,336,306,338,306,341,306,345,303,343,299,342,296,344,290,354,292,379,288,384,289,386,294,386,294";
$coords[basilicaba]="381,338,380,340,379,342,388,345,397,357,402,353,409,353,410,362,411,367,417,372,413,378,409,385,403,384,399,388,397,392,397,397,387,398,382,396,378,394,370,397,369,393,372,386,375,381,373,376,370,374,359,363,361,360,355,353,355,348,358,348,361,344,364,341,363,338,362,337,371,334,377,335,381,338,381,338";
$coords[calabrie]="407,388,408,395,405,400,402,406,403,409,408,414,415,415,432,426,430,432,434,448,431,451,428,453,426,452,425,451,413,455,408,459,407,464,409,476,406,482,400,486,395,491,392,497,390,501,388,508,381,509,374,508,371,507,370,506,371,504,372,503,370,497,370,494,373,492,377,489,383,476,381,472,378,470,384,466,389,464,392,462,394,457,393,452,391,450,388,447,387,443,383,426,378,419,375,413,372,399,374,396,378,396,379,396,383,400,397,400,403,388,407,388,407,388";
$coords[molise]="342,290,340,297,340,299,343,302,339,304,334,305,335,315,326,317,320,320,311,316,304,313,299,313,298,316,298,318,300,320,294,317,296,314,298,312,296,308,295,305,300,302,303,300,305,298,304,295,303,295,304,293,308,292,312,294,316,300,328,283,334,285,342,290,342,290";
$coords[friuli venezia]="280,37,274,42,269,49,269,52,279,55,274,59,272,64,273,68,278,67,276,72,277,75,281,77,286,80,289,86,288,88,285,88,286,85,284,81,281,78,276,77,274,78,273,81,261,77,258,77,257,80,254,75,251,73,241,75,238,73,236,69,234,64,235,60,237,57,234,53,230,50,236,42,240,39,245,36,246,31,253,33,262,34,271,35,280,37,280,37";
$coords[trentino]="224,6,222,7,221,10,225,16,232,28,231,30,227,30,218,26,208,24,203,24,201,24,201,26,202,29,198,34,196,40,196,43,198,46,209,51,209,58,200,59,199,61,199,63,201,65,198,63,192,64,186,69,183,73,183,79,178,79,173,81,173,72,171,70,164,70,162,71,161,75,158,73,157,64,159,56,161,48,160,44,164,41,162,38,158,36,157,30,157,28,154,27,156,24,158,21,157,19,156,20,158,17,162,17,167,20,175,23,179,20,181,16,183,12,189,10,190,11,192,12,194,11,195,10,206,9,219,6,224,6,224,6";
$coords[veneto]="244,31,244,35,235,41,231,45,228,50,232,53,235,57,233,60,232,64,235,71,241,76,252,76,257,85,251,84,246,86,236,93,238,91,236,89,234,89,229,90,225,95,223,100,223,105,223,109,227,110,226,115,230,119,235,123,233,129,232,125,229,127,230,132,226,123,212,120,200,125,191,121,185,116,186,113,190,115,195,115,196,112,194,106,195,103,197,101,194,98,191,98,193,93,189,87,183,81,184,79,185,78,189,70,193,66,197,65,204,67,203,70,204,74,206,77,209,79,217,76,214,73,213,69,213,65,221,57,224,52,225,47,232,36,231,33,230,32,233,32,233,29,244,31,244,31";
$coords[emilia-romagna]="126,114,127,115,129,116,130,114,131,113,132,115,134,113,137,113,138,117,144,118,146,120,149,122,152,120,154,123,158,125,160,123,164,122,166,123,169,125,187,125,187,123,189,123,200,127,212,123,218,123,225,124,226,123,224,140,220,139,219,142,219,145,221,145,225,145,226,153,228,162,234,170,244,179,242,183,235,180,234,179,235,177,233,176,221,179,219,181,219,184,218,187,216,188,206,184,203,180,202,177,203,173,205,170,199,166,194,164,190,162,186,163,182,167,184,169,182,168,176,168,174,167,170,170,166,166,163,165,156,165,150,159,143,157,136,152,135,149,133,146,130,146,123,151,113,149,114,147,116,144,114,140,110,139,105,138,108,135,109,129,110,128,112,126,110,122,110,117,113,114,119,112,121,114,124,116,125,115,126,114,126,114";
$coords[valle d'aosta]="53,64,52,67,55,77,54,79,51,81,48,82,40,80,28,85,20,85,18,78,13,70,14,66,21,64,25,66,43,61,53,64,53,64";
*/
$coords[122]="227,200,234,203,237,206,244,208,245,214,247,222,249,226,248,231,253,237,258,238,260,240,264,242,261,246,259,250,251,253,242,260,239,262,237,264,232,264,232,259,226,259,222,249,217,248,212,247,210,239,210,238,211,238,212,233,216,217,218,219,221,216,223,214,221,210,218,209,219,207,221,205,220,202,219,202,228,198,227,200,227,200";
$coords[123]="351,519,346,540,346,543,348,544,353,547,351,550,353,555,357,559,352,562,348,567,347,574,349,580,338,576,335,577,334,578,327,575,320,572,313,562,307,557,302,555,295,557,288,553,280,547,276,545,274,545,262,535,256,534,250,530,239,530,233,524,230,519,230,518,231,515,232,512,233,507,236,504,240,502,243,499,247,503,251,507,255,505,258,503,258,499,259,498,263,498,267,496,272,502,276,502,281,507,287,509,291,507,296,506,311,506,326,503,327,501,330,499,338,497,342,499,346,501,349,499,357,495,358,493,359,491,360,490,367,491,364,497,359,504,354,511,351,519,351,519";
$coords[124]="133,150,136,154,143,159,148,160,156,167,163,167,170,172,173,170,174,169,176,170,179,171,183,169,185,167,187,165,190,164,194,166,203,169,200,177,200,180,203,183,211,188,220,189,227,190,228,192,222,193,218,198,215,208,221,214,219,217,217,215,215,215,211,222,211,224,212,229,209,237,205,238,203,241,205,245,204,246,203,247,204,250,199,253,195,257,197,260,189,264,182,262,179,263,178,264,177,264,179,261,181,258,178,253,173,248,167,243,163,242,164,237,162,233,158,232,153,233,155,222,153,215,150,208,146,202,145,192,144,184,140,175,136,168,133,165,132,163,128,158,122,153,130,149,133,150,133,150";
$coords[125]="210,250,220,251,221,255,222,258,224,260,230,261,230,266,235,267,237,265,239,263,243,262,251,255,259,252,262,250,264,245,270,252,266,253,262,253,259,256,260,256,261,258,260,260,259,262,261,268,268,276,264,278,259,276,255,277,255,282,256,285,260,288,267,291,268,293,270,296,274,297,282,299,292,303,294,307,296,312,293,314,291,317,289,320,289,325,287,327,285,327,279,327,276,329,271,327,267,325,262,326,258,329,254,324,250,319,239,315,232,307,223,300,219,291,213,285,206,283,202,278,200,273,197,268,192,265,192,263,199,261,197,258,200,253,203,250,206,247,206,242,209,241,210,250,210,250";
$coords[127]="97,325,110,334,108,337,112,338,112,341,110,343,112,344,114,347,114,352,117,359,120,366,118,370,115,374,111,381,115,391,108,429,108,431,110,433,106,437,106,443,104,444,97,440,91,437,88,439,86,438,85,437,82,438,81,440,83,446,79,451,74,455,71,454,64,453,62,448,59,443,56,450,54,447,53,442,58,441,54,436,55,434,58,432,56,429,55,426,56,425,57,424,56,422,55,421,57,418,58,415,59,410,59,405,61,407,64,402,64,399,63,397,61,397,59,398,59,399,57,397,56,395,57,390,62,388,60,382,62,378,60,375,58,374,59,369,55,362,51,358,48,359,48,360,49,357,51,354,49,351,51,347,53,343,51,340,54,334,59,330,59,334,54,336,53,338,54,342,57,345,63,346,71,344,78,339,92,329,93,325,97,325,97,325";
$coords[130]="99,140,106,140,109,141,114,144,111,151,116,150,122,154,125,158,127,163,135,171,132,171,128,168,125,168,126,170,113,159,104,153,103,154,102,155,99,153,98,151,85,148,80,149,75,153,69,160,63,165,58,173,50,177,40,181,34,181,34,176,40,168,45,163,51,165,54,163,57,161,58,157,59,153,61,149,63,144,65,143,67,144,69,145,80,140,85,145,93,140,92,137,99,140,99,140";
$coords[135]="207,26,220,28,227,30,230,36,226,40,223,47,220,57,211,64,211,69,211,72,213,76,208,77,205,69,201,62,206,61,211,58,211,49,204,47,200,45,199,42,205,26,207,26,207,26";
#merengebied
$coords[142]="150,33,154,34,156,37,161,40,161,43,157,43,159,50,154,64,154,72,156,75,159,77,161,75,163,74,167,74,157,85,156,92,162,96,165,96,165,86,166,80,170,76,170,79,172,83,177,81,184,86,190,93,189,94,188,97,189,99,193,101,190,105,192,113,187,111,182,111,181,114,183,117,187,122,176,123,169,122,163,119,160,121,157,123,154,120,151,118,149,119,148,120,146,119,145,117,143,116,139,117,138,111,129,111,128,114,125,112,122,112,123,114,120,111,118,110,113,110,111,113,107,117,106,121,108,126,106,134,96,120,92,115,90,113,86,115,83,112,80,107,77,99,73,95,74,89,73,79,70,71,67,67,63,65,60,66,55,66,54,63,60,57,67,52,64,43,69,42,72,40,72,37,77,37,75,45,79,51,87,57,83,61,79,64,81,69,80,71,79,73,81,75,84,71,84,65,87,63,95,61,94,63,94,65,93,67,94,70,97,73,99,71,103,70,99,63,100,61,103,60,102,58,97,62,100,58,104,53,109,54,109,57,106,61,103,65,105,67,109,65,112,70,113,67,111,61,112,55,115,53,110,53,105,52,108,47,108,43,110,35,114,36,116,41,117,45,122,47,126,45,131,43,136,43,137,47,140,52,143,52,144,49,142,45,146,41,140,39,140,35,142,31,145,30,147,31,150,33,150,33";
$coords[143]="320,322,324,320,330,317,339,316,340,318,340,322,348,326,348,328,346,328,346,331,346,333,348,335,354,336,359,337,361,338,362,341,360,344,357,347,353,345,353,352,355,356,359,359,357,362,358,364,360,365,367,373,372,381,367,390,361,390,358,392,356,395,348,389,342,385,336,383,340,375,337,368,331,360,327,359,320,362,318,361,316,360,313,362,317,357,312,352,307,350,304,352,302,351,301,350,298,350,299,352,298,346,295,340,288,329,290,326,291,323,293,318,298,322,301,322,302,320,301,317,301,315,306,315,313,318,320,322,320,322";
$coords[156]="233,182,241,185,243,182,246,179,270,196,277,199,291,235,282,240,276,241,273,244,270,247,267,244,265,241,262,239,259,236,253,235,252,227,250,224,249,223,247,207,246,205,244,205,243,206,242,207,238,205,236,203,233,201,229,201,230,197,228,196,225,196,225,198,223,197,225,194,230,192,224,188,221,188,221,181,224,182,233,178,233,182,233,182";
$coords[168]="72,79,71,80,70,81,71,84,73,87,72,96,75,100,78,108,81,114,84,116,89,116,97,124,102,130,105,135,103,137,102,139,95,135,90,135,89,138,86,143,83,140,80,138,77,140,69,143,63,141,62,146,60,149,58,151,56,158,54,160,50,163,45,161,42,161,38,159,30,161,22,158,15,153,10,146,9,139,10,135,14,133,17,130,19,126,18,121,17,119,16,119,11,118,7,116,4,106,23,99,26,91,24,86,27,88,32,85,38,83,42,82,47,83,52,83,58,80,55,68,64,67,66,68,69,72,72,79,72,79";
$coords[195]="244,31,244,35,235,41,231,45,228,50,232,53,235,57,233,60,232,64,235,71,241,76,252,76,257,85,251,84,246,86,236,93,238,91,236,89,234,89,229,90,225,95,223,100,223,105,223,109,227,110,226,115,230,119,235,123,233,129,232,125,229,127,230,132,226,123,212,120,200,125,191,121,185,116,186,113,190,115,195,115,196,112,194,106,195,103,197,101,194,98,191,98,193,93,189,87,183,81,184,79,185,78,189,70,193,66,197,65,204,67,203,70,204,74,206,77,209,79,217,76,214,73,213,69,213,65,221,57,224,52,225,47,232,36,231,33,230,32,233,32,233,29,244,31,244,31";


echo "<div id=\"landkaartklikbaar\">";
#echo "<h2>Kaart ".htmlentities($themalandinfo["naam"])."</h2>";
echo "<div id=\"landkaartklikbaar_info\"></div>";


echo "<div id=\"landkaartklikbaar_kaart\">";

echo "<script>\nvar landkaart_hoverkleur='".$landkaart_hoverkleur."';\nvar landkaartklikbaar_info_hoverkleur='#ff9900';\n</script>";

unset($inquery);
while(list($key,$value)=each($coords)) {
	$inquery.=",".$key;
}
$db->query("SELECT skigebied_id, naam FROM skigebied WHERE skigebied_id IN (".substr($inquery,1).") ORDER BY naam;");
while($db->next_record()) {
	$regio["naam"][$db->f("skigebied_id")]=$db->f("naam");
}

echo "<img src=\"".$vars["path"]."pic/landkaart_".$img_land."_italissima.png?c=".@filemtime("pic/landkaart_".$img_land."_italissima.png")."\" border=\"0\" class=\"map\" style=\"".$img_style."\" usemap=\"#map\">";
echo "<map name=\"map\">";
reset($coords);
while(list($key,$value)=each($coords)) {
	if($regio["aantal_acc"][$key]) {
		echo "<area href=\"".$vars["path"].txt("menu_skigebied")."/".wt_convert2url($regio["naam"][$key])."/\" rel=\"".$key."\" shape=\"poly\" title=\"".htmlentities($regio["naam"][$key]).": ".intval($regio["aantal_acc"][$key])." ".($regio["aantal_acc"][$key]==1 ? "vakantiehuis" : "vakantiehuizen")."\" coords=\"".$value."\" class=\"maphref\" id=\"area".$key."\">\n";
	} else {
#		echo "<area href=\"#\" rel=\"".$key."\" shape=\"poly\" title=\"".htmlentities($regio["naam"][$key])."\" coords=\"".$value."\" class=\"maphref nomaphref\" id=\"area".$key."\">\n";
	}
}
echo "</map>";

echo "</div>"; # afsluiten landkaartklikbaar_kaart

echo "<div id=\"landkaartklikbaar_namen\">";

if($inquery) {
	$db->query("SELECT skigebied_id, naam FROM skigebied WHERE skigebied_id IN (".substr($inquery,1).") ORDER BY naam;");
	while($db->next_record()) {
		if($regio["aantal_acc"][$db->f("skigebied_id")]) {
			echo "<div id=\"regio_".$db->f("skigebied_id")."\" class=\"landnaam\" rel=\"".$db->f("skigebied_id")."\"><a href=\"".$vars["path"].txt("menu_skigebied")."/".wt_convert2url($db->f("naam"))."/\">".htmlentities($db->f("naam"))."</a> (".intval($regio["aantal_acc"][$db->f("skigebied_id")]).")</div>";
		}
	}
}
echo "</div>"; # afsluiten landkaartklikbaar_namen

echo "<div style=\"clear:both;\"></div>";

echo "</div>"; # afsluiten landkaartklikbaar



?>